// ---- {{& method.upper }} {{& path }} -------------------
export namespace {{& operationId }} {
  export type Request = {
    {{#parameters}}
    {{& name }}{{^required}}?{{/required}}: {{& type_code }};
    {{/parameters}}
  }
  export function make_request(ctx: KoaRouter.IRouterContext): Request {
    return {
      {{#parameters}}
      {{& name }}: {{!
        }}sctk.{{&decoder}}(ctx.{{& container }}.{{& name }}, {{& schema_code }}),
      {{/parameters}}
    };
  }
  {{#responses}}
  export type Response{{& status.pascalcase }} = {{& type_code }};
  {{/responses}}
  export type Response = {
    status: number;
    body: {{& response_types }};
  };
  export interface Handler {
    (req:Request): Promise<Response>;
  };
  export function route(router:Router) {
    router.{{& method.lower }}('{{& fullpath }}', async (ctx_) => {
      const ctx = <any>ctx_;  //KoaRouter.Router.IRouterContext;
      const router = ctx.router as Router;
      if (router.swagger.{{& operationId }}) {
        const req = make_request(ctx);
        const res = await router.swagger.{{& operationId }}!(req);
        ctx.status = res.status;
        ctx.body   = res.body;
      } else {
        ctx.status = 500;
        ctx.body = {
          details: 'not implemented yet'
        };
      }
    });
  }
}
/*
function UserGetTestRequest(ctx: KoaRouter.IRouterContext): UserGetTestRequest {
  return {
    user_id: ctx.params.user_id,
    yell_card_id: ctx.query.yell_card_id,
    foo: ctx.query.foo,
  };
}
export interface UserGetTestResponse200 {
  a: string;
  b: number;
  c?: string;
}
export interface UserGetTestResponse400 {
  details: string;
}
export interface UserGetTestResponse {
  status: number;
  body:   UserGetTestResponse200 | UserGetTestResponse400;
}
*/
